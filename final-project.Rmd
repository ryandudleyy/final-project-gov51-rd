---
title: "final-project"
output: pdf_document
---

```{r setup, include=FALSE, echo = FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
```

# Proliferation of Regime Types Across Time

Before I get into this, I just want to communicate that I do not know the actual parameters of this assignment, both for now and for the final project as a whole. I actually thought this was due today, not one week ago.

The purpose of this project is to observe the changes in regime type prevalence relative to the strength of certain regimes, using a temporal and geographic lens in order to better understand the effect that major regime changes can have on surrounding regions. In order to understand this, the study is going to look at a number of cases over the course of the 20th century, with the Soviet Union and single party regimes being an example. The analysis will be conducted over the course of multiple year ranges and geographic locations; it will consist of a number of cases and analyses. 

The data comes from a study published on March 14th, 2018 by Carsten Anckar and Cecilia Fredriksson in the Journal of European Political Science. It classifies political regimes from 1800 to 2016, using classifications which include a country's democratic/non-democratic status, a country's regime type (presidentialist, parliamentarian, personalist rule, etc.) and whether a country's head of state is popularly elected. The data in question is updated over the course of years, meaning that countries' regimes change over time during the dataset; consequently, the observed slopes are likely to be quite gentle. 
```{r data, echo = FALSE}

data <- readxl::read_xlsx("data/41304_2018_149_MOESM2_ESM (1).xlsx")

# This was to make viewing the countries on the list easier. 

y2000 <- data %>%
  filter(year == "2000")
view(y2000)

# This makes regression across the government types easier. 

data <- data %>%
  mutate(parliamentarism = ifelse(regimenarrowcat == 0, 1, 0),
         semipresidentialism = ifelse(regimenarrowcat == 1, 1, 0),
         presidentialism = ifelse(regimenarrowcat == 2, 1, 0),
         semimonarchy = ifelse(regimenarrowcat == 3, 1, 0),
         singleparty = ifelse(regimenarrowcat == 4, 1, 0),
         multipartyauthoritarian = ifelse(regimenarrowcat == 5, 1, 0),
         personalist = ifelse(regimenarrowcat == 6, 1, 0),
         military = ifelse(regimenarrowcat == 7, 1, 0),
         absolutemonarchy = ifelse(regimenarrowcat == 8, 1, 0),
         monarchicoligarchy = ifelse(regimenarrowcat == 9, 1, 0),
         otheroligarchy = ifelse(regimenarrowcat == 10, 1, 0),
         missing = ifelse(regimenarrowcat == 99, 1, 0))

# This allows for an easier geographic perspective. 

data <- data %>%
  mutate(asian = ifelse(
    ccode >= 630, 1, 0),
    african = ifelse(
      ccode >= 402 & ccode < 630, 1, 0),
    european = ifelse(
      ccode >= 200 & ccode <= 395, 1, 0),
    american = ifelse(
      ccode >= 2 & ccode < 200, 1, 0))



```

```{r ussr, echo = FALSE}

data_ussr <- data %>%
  mutate(year_new = year - 1900) %>%
  filter(year_new > 17) %>%
  select(year_new, singleparty)

lm_ussr <- lm(singleparty ~ year_new, data = data_ussr)

summary(lm_ussr)$adj.r.squared

data_ussr_alt <- data %>%
  mutate(year_new = year - 1900) %>%
  filter(year_new > 50) %>%
  select(year_new, singleparty)

lm_ussr_alt <- lm(singleparty ~ year_new, data = data_ussr_alt)

summary(lm_ussr_alt)$adj.r.squared

# The alt was designed to better compare with ussr2

data_ussr2 <- data %>%
  mutate(year_new = year - 1900) %>%
  filter(year_new > 17, european == 1) %>%
  select(year_new, singleparty)

lm_ussr2 <- lm(singleparty ~ year_new, data = data_ussr2)

lm_ussr2_sq <- lm(singleparty ~ year_new +
                    I(year_new^2), data = data_ussr2)

summary(lm_ussr2)$adj.r.squared

summary(lm_ussr2_sq)$adj.r.squared

lm_ussr2_sq_values <- data_ussr2 %>% select(year_new, singleparty)
lm_ussr2_sq_values$ussr2_sq_values <-
  predict(lm_ussr2_sq, newdata = lm_ussr2_sq_values)

# First regression includes all countries, second only includes Europe. 

data_ussr3 <- data %>%
  mutate(year_new = year - 1900) %>%
  filter(year_new > 50, european == 1) %>%
  select(year_new, singleparty)

lm_ussr3 <- lm(singleparty ~ year_new, data = data_ussr3)

lm_ussr3_sq <- lm(singleparty ~ year_new +
                    I(year_new^2), data = data_ussr3)

summary(lm_ussr3)$adj.r.squared

summary(lm_ussr3_sq)$adj.r.squared

data_ussr3_alt <- data %>%
  mutate(year_new = year - 1900) %>%
  filter(year_new > 50, european == 1 | asian == 1) %>%
  select(year_new, singleparty)

lm_ussr3_alt <- lm(singleparty ~ year_new, data = data_ussr3_alt)

lm_ussr3_alt_sq <- lm(singleparty ~ year_new +
                    I(year_new^2), data = data_ussr3_alt)

summary(lm_ussr3_alt)$adj.r.squared

summary(lm_ussr3_alt_sq)$adj.r.squared

# Third regression changes the baseline year. 

data_ussr4 <- data %>%
  mutate(year_new = year - 1900) %>%
  filter(year_new > 75, european == 1) %>%
  select(year_new, singleparty)

lm_ussr4 <- lm(singleparty ~ year_new, data = data_ussr4)

summary(lm_ussr4)$adj.r.squared

data_ussr5 <- data %>%
  mutate(year_new = year - 1900) %>%
  filter(year_new > 87, european == 1) %>%
  select(year_new, singleparty)

lm_ussr5 <- lm(singleparty ~ year_new, data = data_ussr5)

summary(lm_ussr5)$adj.r.squared

# The fourth and fifth regressions also change baseline year.

# Interestingly, the correlation shifts significantly over time. 

```

## The Case of the USSR

(there will be more graphs in the final version)

The below two graphs show two ways of interpreting the potential spread of single party regimes following the emergence of the Soviet Union in 1917. The independent variable is the year, while the dependent variable is the prevalence of single party regimes. The difference between the two graphs is what region they cover: the first graph includes all the world's countries, whereas the second graph limits the analysis to only Europe. All of the lines in these graphs were modified by a 30x multiplier to better reflect the data; it should be notified that this multiplier only exists to make the lines more visible and, though the numbers are proportional, the axes should not be considered when observing the lines. 

The first graph depicts the distribution of single party regimes in the world over the course of the 20th century. The data begins in 1917, the year of the Russian Revolution. It is important to note that the prevalence of single party regimes does not change significantly following 1917, but rather following 1945. 

The second graph depicts the distribution of single party regimes specifically in Europe over the 20th century. In this graph, there are two lines: a linear line and a quadratic line. The linear line's r-squared is 0.006696221, whereas the r-squared the quadratic line is 0.08567992, meaning the quadratic line better fits the data. The quadratic model reflects the rise and fall of the single party regime type over the course of the 20th century, as the USSR gained prevalence and fell over the course of 80 years. 

```{r ussrgeom, echo = FALSE}

ussr_geom <- ggplot(data = data_ussr, mapping = 
                      aes(x = year_new, y = singleparty)) +
  geom_col(aes(y = singleparty)) +
  geom_abline(intercept = .1431769 * 30, slope = -0.0006335 * 30) +
  ylim(0, 40) + 
  xlim(15, 100) + 
  theme_bw() +
  labs(title = "Single Party Regimes in the 20th century",
       x = "Years since 1900",
       y = "Single Party Regimes")

# Both of these lines have been modified by a flat 30x multiplier
# in order to better compare the graphs with the data set
# this multiplier is arbitrary

ussr2_geom <- ggplot(data = data_ussr2, mapping = 
                      aes(x = year_new, y = singleparty)) +
  geom_col(aes(y = singleparty)) +
  geom_line(aes(y = 30*lm_ussr2_sq_values$ussr2_sq_values), color = "red") +
  geom_abline(intercept = .1859563 * 30, slope = - 0.0009342* 30,
              color = "blue") +
  ylim(0, 10) + 
  xlim(15, 100) + 
  theme_bw() +
  labs(title = "Single Party Regimes in 20th century Europe",
       x = "Years since 1900",
       y = "Single Party Regimes in Europe")

ussr_geom
ussr2_geom



```

## The Case of China

```{r china, echo = FALSE}

data_china <- data %>%
  mutate(year_new = year - 1900) %>%
  filter(year_new > 49) %>%
  select(year_new, singleparty)

lm_china <- lm(singleparty ~ year_new, data = data_china)

summary(lm_china)$adj.r.squared

data_china2 <- data %>%
  mutate(year_new = year - 1900) %>%
  filter(year_new > 49, asian == 1) %>%
  select(year_new, singleparty)

lm_china2 <- lm(singleparty ~ year_new, data = data_china2)

summary(lm_china2)$adj.r.squared

data_china3 <- data %>%
  mutate(year_new = year - 1900) %>%
  filter(year_new > 75, asian == 1) %>%
  select(year_new, singleparty)

lm_china3 <- lm(singleparty ~ year_new, data = data_china3)

summary(lm_china3)$adj.r.squared


``` 

## Code

```{r print-code, ref.label=knitr::all_labels(), echo = TRUE, eval=FALSE}
## This command will print all of your named chunks
```



